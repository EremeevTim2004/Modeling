Условие задачи: Одним из основных законов теории скоростей химических реакций является закон действующих масс, согласно которому скорость химической реакции при постоянной температуре пропорциональна произведению концентраций веществ, участвующих в данный момент в реакции.

Решим следующую задачу. Два жидких химических вещества $A$ и $B$ объемом $V_{a}$ и $V_{b}$ соответственно в процессе химической реакции образуют новое жидкое химическое вещество $C$. Полагая, что температура в процессе реакции не меняется, а также что из каждых двух объемов вещества $A$ и одного объема вещества $B$ образуется три объема вещества $C$, получаем зависимость количества вещества $C$ от времени в виде дифференциального уравнения $\frac{dx}{dt} = k (V_{a} - \frac{2}{3} * x)(V_{b} - \frac{1}{3} * x)$, где $x$ - объем (в литрах) вещества $C$, $k$ - положительный коэффициент пропорционально равный $0.02$. Определить время для полного прекращения реакции, а также объем вещества $A$ и $B$ в момент прекращения реакции.

Решение задачи (листинг):

\begin{minted}{python}
import numpy as np
from scipy.integrate import solve_ivp
import matplotlib.pyplot as plt

# Исходные данные
Va = float(input("Введите объем вещества A (Va) в литрах: "))
Vb = float(input("Введите объем вещества B (Vb) в литрах: "))
k = 0.02  # коэффициент пропорциональности

def reaction_rate(t, x):
    """
    Функция для расчета скорости реакции dx/dt.
    """
    return k * (Va - (2 / 3) * x) * (Vb - (1 / 3) * x)

# Максимальный объем вещества C
x_max = min(3 * Va / 2, 3 * Vb)

# Решение дифференциального уравнения
sol = solve_ivp(
    reaction_rate,              # функция скорости реакции
    [0, 1e5],                   # временной интервал (достаточно большой для прекращения реакции)
    [0],                        # начальное значение x (объем C в начале реакции)
    method='RK45',              # метод численного решения
    dense_output=True           # для получения непрерывного решения
)

# Определение времени прекращения реакции
for i, x in enumerate(sol.y[0]):
    if x >= x_max:
        time_end = sol.t[i]  # время прекращения реакции
        break
else:
    time_end = sol.t[-1]

# Объемы веществ A и B в момент прекращения реакции
x_final = x_max
Va_final = Va - (2 / 3) * x_final
Vb_final = Vb - (1 / 3) * x_final

# Вывод результатов
print("Результаты:")
print(f"Время полного прекращения реакции: {time_end:.2f} секунд")
print(f"Остаточный объем вещества A: {Va_final:.2f} литров")
print(f"Остаточный объем вещества B: {Vb_final:.2f} литров")

# График
t_vals = np.linspace(0, time_end, 500)
x_vals = sol.sol(t_vals)[0]

plt.figure(figsize=(10, 6))
plt.plot(t_vals, x_vals, label="Объем вещества C")
plt.axhline(y=x_max, color='r', linestyle='--', label="Максимальный объем вещества C")
plt.xlabel("Время (с)")
plt.ylabel("Объем вещества C (литры)")
plt.title("Динамика образования вещества C")
plt.legend()
plt.grid()
plt.show()
\end{minted}

Вывод:

\begin{minted}{shell}
    Введите объем вещества A (Va) в литрах: 100
    Введите объем вещества B (Vb) в литрах: 20
    Результаты:
    Время полного прекращения реакции: 100000.00 секунд
    Остаточный объем вещества A: 60.00 литров
    Остаточный объем вещества B: 0.00 литров
    Объем вещества C в литрах: 60
\end{minted}